<div x-data="{ slideIndex: 0, slides: {{ images|length }}, timer: null, modalOpen: false, modalImage: '', scale: 1, dragging: false, posX: 0, posY: 0, startPosX: 0, startPosY: 0, hasMoved: false }"
     x-init="timer = setInterval(() => slideIndex = (slideIndex + 1) % slides, 3000)"
     @mouseenter="clearInterval(timer)"
     @mouseleave="timer = setInterval(() => slideIndex = (slideIndex + 1) % slides, 3000)"
     @keydown.escape.window="modalOpen = false; $body.classList.remove('overflow-hidden'); scale = 1"
     class="relative w-full mx-auto overflow-hidden bg-gray-50 rounded shadow-lg max-w-2xl max-h-[42rem]">
  <!-- Max Width -->
  <div class="flex transition-transform duration-1000"
       :style="'transform: translateX(-' + (slideIndex * 100) + '%)'">
    {% for image in images %}
      <div @click="modalOpen = true, modalImage = '{{ image.image.url }}'"
           class="relative flex-none w-full h-full cursor-pointer flex items-center justify-center">
        <img src="{{ image.image.url }}"
             alt="Product Image"
             class="object-contain max-h-full max-w-full">
      </div>
    {% endfor %}
  </div>
  <!-- Image Modal -->
  <div x-show="modalOpen"
       x-cloak
       class="fixed inset-0 z-50 bg-black bg-opacity-75 flex items-center justify-center"
       @click="if (!hasMoved) { modalOpen = false; $body.classList.remove('overflow-hidden'); scale = 1; hasMoved = false; }"
       @wheel="scale += $event.deltaY * -0.002; $event.preventDefault();">
    <div :class="{ 'cursor-grab': !dragging, 'cursor-grabbing': dragging }"
         class="relative max-w-full max-h-screen"
         :style="'transform: translate(' + posX + 'px, ' + posY + 'px) scale(' + scale + ')'"
         style="transform-origin: center"
         @mousedown="dragging = true, startPosX = $event.clientX - posX, startPosY = $event.clientY - posY; hasMoved = false;"
         @mousemove.window="if (dragging) { posX = $event.clientX - startPosX; posY = $event.clientY - startPosY; hasMoved = true; }"
         @mouseup.window="dragging = false"
         @mouseleave.window="dragging = false"
         @dragstart="event.preventDefault();">
      <img :src="modalImage"
           class="block max-w-full max-h-screen mx-auto"
           alt="Modal Image"
           draggable="false">
    </div>
  </div>
</div>
